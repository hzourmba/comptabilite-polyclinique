<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guide de Comptabilit√© - Syst√®me Comptable Multi-Devises</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f8f9fa;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: white;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }

        header {
            background: linear-gradient(135deg, #2c3e50, #3498db);
            color: white;
            padding: 2rem;
            text-align: center;
            margin-bottom: 2rem;
            border-radius: 10px;
        }

        .update-badge {
            background: #27ae60;
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            margin-left: 1rem;
            display: inline-block;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        h2 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 0.5rem;
            margin: 2rem 0 1rem 0;
            font-size: 1.8rem;
        }

        h3 {
            color: #34495e;
            margin: 1.5rem 0 1rem 0;
            font-size: 1.3rem;
        }

        h4 {
            color: #7f8c8d;
            margin: 1rem 0 0.5rem 0;
            font-size: 1.1rem;
        }

        .toc {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .toc h2 {
            margin-top: 0;
            border-bottom: 2px solid #6c757d;
        }

        .toc ol {
            margin-left: 1.5rem;
        }

        .toc a {
            color: #3498db;
            text-decoration: none;
        }

        .toc a:hover {
            text-decoration: underline;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .feature-card {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 1rem;
        }

        .feature-card h4 {
            color: #2c3e50;
            margin-bottom: 0.5rem;
        }

        .role-card {
            background: linear-gradient(135deg, #ecf0f1, #bdc3c7);
            border-left: 4px solid #3498db;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 8px 8px 0;
        }

        .code-block {
            background-color: #2c3e50;
            color: #ecf0f1;
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            margin: 1rem 0;
        }

        .highlight {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 6px;
            padding: 1rem;
            margin: 1rem 0;
        }

        .success {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }

        .info {
            background-color: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
        }

        .warning {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }

        th, td {
            border: 1px solid #dee2e6;
            padding: 0.75rem;
            text-align: left;
        }

        th {
            background-color: #f8f9fa;
            font-weight: bold;
        }

        .emoji {
            font-size: 1.2em;
        }

        .new-feature {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            padding: 0.2rem 0.6rem;
            border-radius: 15px;
            font-size: 0.8rem;
            margin-left: 0.5rem;
        }

        .architecture-tree {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 1.5rem;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            margin: 1rem 0;
            white-space: pre;
        }

        footer {
            background: #2c3e50;
            color: white;
            text-align: center;
            padding: 2rem;
            margin-top: 2rem;
            border-radius: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Guide de Comptabilit√©</h1>
            <p>Syst√®me Comptable Multi-Devises</p>
            <span class="update-badge">‚ú® Version mise √† jour - Octobre 2025</span>
        </header>

        <div class="toc">
            <h2>Table des Mati√®res</h2>
            <ol>
                <li><a href="#vue-ensemble">Vue d'ensemble du syst√®me</a></li>
                <li><a href="#gestion-utilisateurs">Gestion des utilisateurs et s√©curit√©</a> <span class="new-feature">NOUVEAU</span></li>
                <li><a href="#configuration-entreprises">Configuration des entreprises et devises</a></li>
                <li><a href="#plan-comptable">Plan comptable et num√©rotation</a></li>
                <li><a href="#capital-actionnaires">Gestion du capital et des actionnaires</a></li>
                <li><a href="#ecritures-comptables">√âcritures comptables</a></li>
                <li><a href="#etats-financiers">√âtats financiers</a></li>
                <li><a href="#troubleshooting">Troubleshooting et bonnes pratiques</a></li>
            </ol>
        </div>

        <section id="vue-ensemble">
            <h2>Vue d'ensemble du syst√®me</h2>

            <h3>Caract√©ristiques principales</h3>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4><span class="emoji">üåç</span> Multi-devises</h4>
                    <p>Support Euro (‚Ç¨) et Franc CFA (FCFA)</p>
                </div>
                <div class="feature-card">
                    <h4><span class="emoji">üìä</span> Multi-normes</h4>
                    <p>Comptabilit√© fran√ßaise et OHADA/Cameroun</p>
                </div>
                <div class="feature-card">
                    <h4><span class="emoji">üë•</span> Gestion des actionnaires</h4>
                    <p>Suivi d√©taill√© des souscriptions et lib√©rations</p>
                </div>
                <div class="feature-card">
                    <h4><span class="emoji">üìà</span> √âtats financiers automatis√©s</h4>
                    <p>Balance, Grand Livre, Bilan, Compte de R√©sultat</p>
                </div>
            </div>

            <h3>Architecture des donn√©es</h3>
            <div class="architecture-tree">Entreprise
‚îú‚îÄ‚îÄ Utilisateurs (avec r√¥les et permissions)
‚îú‚îÄ‚îÄ Exercices comptables
‚îú‚îÄ‚îÄ Plan comptable (Comptes)
‚îÇ   ‚îú‚îÄ‚îÄ Comptes principaux
‚îÇ   ‚îî‚îÄ‚îÄ Sous-comptes (actionnaires, etc.)
‚îú‚îÄ‚îÄ Journaux
‚îî‚îÄ‚îÄ √âcritures comptables
    ‚îî‚îÄ‚îÄ Lignes d'√©criture</div>

            <h3>Nouveaut√©s de la version actuelle</h3>
            <div class="highlight success">
                <ul>
                    <li><strong>‚úÖ Gestion compl√®te des utilisateurs</strong> : Cr√©ation, modification, activation/d√©sactivation</li>
                    <li><strong>‚úÖ Syst√®me de r√¥les et permissions</strong> : Administrateur, Comptable, Assistant Comptable, Consultant</li>
                    <li><strong>‚úÖ S√©curit√© renforc√©e</strong> : Authentification hybride, contr√¥le d'acc√®s bas√© sur les r√¥les</li>
                    <li><strong>‚úÖ Initialisation automatique d'entreprise</strong> : Cr√©ation automatique de l'exercice, plan comptable et utilisateur administrateur</li>
                    <li><strong>‚úÖ Interface intuitive</strong> : Gestion des permissions dynamiques dans l'interface</li>
                    <li><strong>‚úÖ Profil utilisateur</strong> : Possibilit√© de modifier ses informations personnelles et mot de passe</li>
                </ul>
            </div>
        </section>

        <section id="gestion-utilisateurs">
            <h2>Gestion des utilisateurs et s√©curit√© <span class="new-feature">NOUVEAU</span></h2>

            <h3>Syst√®me de r√¥les</h3>
            <p>Le syst√®me impl√©mente un contr√¥le d'acc√®s bas√© sur les r√¥les (RBAC) avec quatre niveaux de permissions :</p>

            <div class="role-card">
                <h4>1. <span class="emoji">üëë</span> ADMINISTRATEUR</h4>
                <ul>
                    <li><strong>Permissions compl√®tes</strong> : Acc√®s √† toutes les fonctionnalit√©s</li>
                    <li><strong>Gestion des utilisateurs</strong> : Cr√©ation, modification, activation/d√©sactivation</li>
                    <li><strong>Administration du syst√®me</strong> : Configuration entreprise, param√®tres globaux</li>
                </ul>
            </div>

            <div class="role-card">
                <h4>2. <span class="emoji">üìä</span> COMPTABLE</h4>
                <ul>
                    <li><strong>√âcritures comptables</strong> : Cr√©ation, modification, validation</li>
                    <li><strong>√âtats financiers</strong> : G√©n√©ration de tous les rapports</li>
                    <li><strong>Plan comptable</strong> : Gestion des comptes</li>
                    <li><strong>Consultation utilisateurs</strong> : Lecture seule</li>
                </ul>
            </div>

            <div class="role-card">
                <h4>3. <span class="emoji">‚úèÔ∏è</span> ASSISTANT_COMPTABLE</h4>
                <ul>
                    <li><strong>Saisie d'√©critures</strong> : Cr√©ation et modification d'√©critures</li>
                    <li><strong>Consultation</strong> : Acc√®s en lecture aux √©tats financiers</li>
                    <li><strong>Pas d'acc√®s</strong> : Administration syst√®me</li>
                </ul>
            </div>

            <div class="role-card">
                <h4>4. <span class="emoji">üëÅÔ∏è</span> CONSULTANT</h4>
                <ul>
                    <li><strong>Lecture seule</strong> : Consultation des √©tats financiers uniquement</li>
                    <li><strong>Pas de modification</strong> : Aucune √©criture ou changement</li>
                </ul>
            </div>

            <h3>Interface de gestion des utilisateurs</h3>

            <h4>Acc√®s √† l'interface</h4>
            <div class="code-block">Menu ‚Üí Administration ‚Üí Gestion des utilisateurs
(Accessible uniquement aux administrateurs)</div>

            <h4>Fonctionnalit√©s disponibles</h4>

            <div class="highlight info">
                <strong>üìã Liste des utilisateurs :</strong>
                <ul>
                    <li>Statut (‚úÖ Actif / ‚ùå Inactif)</li>
                    <li>Nom d'utilisateur</li>
                    <li>Nom complet (Pr√©nom + Nom)</li>
                    <li>Adresse email</li>
                    <li>R√¥le (traduit en fran√ßais)</li>
                    <li>Derni√®re connexion</li>
                </ul>
            </div>

            <div class="highlight info">
                <strong>üîß Actions disponibles :</strong>
                <ul>
                    <li><strong>‚ûï Ajouter</strong> : Cr√©er un nouvel utilisateur</li>
                    <li><strong>‚úèÔ∏è Modifier</strong> : √âditer les informations (double-clic possible)</li>
                    <li><strong>üîÑ Activer/D√©sactiver</strong> : Changer le statut d'un utilisateur</li>
                    <li><strong>üîÑ Actualiser</strong> : Recharger la liste</li>
                </ul>
            </div>

            <h3>Cr√©ation d'un nouvel utilisateur</h3>

            <h4>Informations requises</h4>
            <div class="code-block">Nom d'utilisateur : [Unique dans l'entreprise]
Pr√©nom          : [Obligatoire]
Nom             : [Obligatoire]
Email           : [Unique, format valide]
R√¥le            : [S√©lection parmi les 4 r√¥les]
Mot de passe    : [Minimum 6 caract√®res]
Confirmation    : [Doit correspondre]
Statut          : [Actif par d√©faut]</div>

            <h4>Validation automatique</h4>
            <div class="highlight success">
                <ul>
                    <li>‚úÖ <strong>Unicit√©</strong> : Nom d'utilisateur et email uniques</li>
                    <li>‚úÖ <strong>Format email</strong> : Validation du format</li>
                    <li>‚úÖ <strong>Mot de passe</strong> : Longueur minimale et confirmation</li>
                    <li>‚úÖ <strong>Champs obligatoires</strong> : Tous les champs requis</li>
                </ul>
            </div>

            <h3>S√©curit√© des mots de passe</h3>

            <h4>Syst√®me hybride</h4>
            <p>Le syst√®me supporte deux formats de mots de passe pour la compatibilit√© :</p>

            <div class="highlight success">
                <strong>Nouveaux utilisateurs (recommand√©) :</strong>
                <div class="code-block">// Hashage automatique lors de la cr√©ation
String hashedPassword = Integer.toString(password.hashCode());</div>
            </div>

            <div class="highlight warning">
                <strong>Anciens utilisateurs (legacy) :</strong>
                <div class="code-block">// Authentification compatible avec mots de passe en clair
boolean isValid = passwordInDb.equals(plainPassword) ||
                  passwordInDb.equals(hashedPassword);</div>
            </div>

            <h4>Mise √† jour des mots de passe</h4>
            <ul>
                <li><strong>Changement via profil</strong> : Nouveau mot de passe automatiquement hash√©</li>
                <li><strong>Migration progressive</strong> : Les anciens mots de passe sont hash√©s lors du changement</li>
            </ul>

            <h3>Contr√¥le d'acc√®s interface</h3>

            <h4>Protection menu Administration</h4>
            <div class="code-block">// Configuration dynamique des permissions
private void configureMenuPermissions() {
    boolean isAdministrateur = authService.isAdministrateur();
    userManagementMenuItem.setDisable(!isAdministrateur);
}</div>

            <h4>V√©rification backend</h4>
            <div class="code-block">// Protection double au niveau contr√¥leur
@FXML
private void showUtilisateurs(ActionEvent event) {
    if (!authenticationService.isAdministrateur()) {
        showError("Acc√®s refus√©", "Seuls les administrateurs...");
        return;
    }
    // ... Continuer uniquement si autoris√©
}</div>

            <h3>Profil utilisateur</h3>

            <h4>Acc√®s au profil</h4>
            <div class="code-block">Menu ‚Üí Administration ‚Üí Mon profil
(Accessible √† tous les utilisateurs connect√©s)</div>

            <h4>Fonctionnalit√©s du profil</h4>
            <ul>
                <li><strong>üë§ Informations personnelles</strong> : Pr√©nom, nom, email</li>
                <li><strong>üîê Changement de mot de passe</strong> : Avec v√©rification de l'ancien mot de passe</li>
                <li><strong>üè¢ Informations entreprise</strong> : Affichage en lecture seule</li>
                <li><strong>üìÖ Derni√®re connexion</strong> : Information de s√©curit√©</li>
            </ul>
        </section>

        <section id="configuration-entreprises">
            <h2>Configuration des entreprises et devises</h2>

            <h3>D√©tection automatique de la devise</h3>
            <p>Le syst√®me d√©tecte automatiquement la devise et les normes comptables :</p>

            <h4>Entreprises OHADA (FCFA)</h4>
            <ul>
                <li><strong>Pays</strong> : Cameroun, S√©n√©gal, C√¥te d'Ivoire, etc.</li>
                <li><strong>Devise</strong> : Franc CFA (FCFA)</li>
                <li><strong>Format num√©rotation</strong> : CMxxxxxxx</li>
                <li><strong>S√©parateur d√©cimal</strong> : Espace (ex: 1 000 000)</li>
            </ul>

            <h4>Entreprises Europ√©ennes (Euro)</h4>
            <ul>
                <li><strong>Pays</strong> : France, Allemagne, Belgique, etc.</li>
                <li><strong>Devise</strong> : Euro (‚Ç¨)</li>
                <li><strong>Format num√©rotation</strong> : xxxxxxx</li>
                <li><strong>S√©parateur d√©cimal</strong> : Virgule (ex: 1 000 000,00)</li>
            </ul>

            <h3>Cr√©ation d'une nouvelle entreprise <span class="new-feature">AM√âLIOR√â</span></h3>

            <h4>Interface de cr√©ation</h4>
            <div class="code-block">Menu ‚Üí Fichier ‚Üí Nouvelle entreprise</div>

            <h4>D√©tection intelligente de la devise</h4>
            <p>Le syst√®me d√©tecte automatiquement la devise et le plan comptable en fonction du contexte utilisateur :</p>

            <div class="highlight info">
                <strong>Utilisateur admin_france :</strong>
                <ul>
                    <li>Pays : France (par d√©faut)</li>
                    <li>Devise : Euro (‚Ç¨)</li>
                    <li>Plan comptable : Fran√ßais (sans pr√©fixe CM)</li>
                </ul>
            </div>

            <div class="highlight info">
                <strong>Autres utilisateurs :</strong>
                <ul>
                    <li>Pays : Cameroun (par d√©faut)</li>
                    <li>Devise : Franc CFA (FCFA)</li>
                    <li>Plan comptable : OHADA (avec pr√©fixe CM)</li>
                </ul>
            </div>

            <h4>Initialisation automatique <span class="new-feature">NOUVEAU</span></h4>
            <p>Lors de la cr√©ation d'une entreprise, le syst√®me initialise automatiquement :</p>

            <div class="highlight success">
                <ol>
                    <li><strong>üìÖ Exercice comptable</strong> : Exercice courant (du 1er janvier au 31 d√©cembre)</li>
                    <li><strong>üë§ Utilisateur administrateur</strong> : Compte admin par d√©faut avec email g√©n√©r√©</li>
                    <li><strong>üìä Plan comptable de base</strong> : Comptes essentiels selon les normes (fran√ßaise ou OHADA)</li>
                </ol>
            </div>

            <h4>Comptes cr√©√©s automatiquement</h4>

            <div class="highlight">
                <strong>Plan comptable fran√ßais :</strong>
                <div class="code-block">101000 - Capital social
106000 - R√©serves
120000 - R√©sultat de l'exercice
411000 - Clients
401000 - Fournisseurs
512000 - Banque
530000 - Caisse</div>
            </div>

            <div class="highlight">
                <strong>Plan comptable OHADA :</strong>
                <div class="code-block">CM101000 - Capital social
CM106000 - R√©serves
CM120000 - R√©sultat de l'exercice
CM411000 - Clients
CM401000 - Fournisseurs
CM521000 - Banque
CM571000 - Caisse</div>
            </div>
        </section>

        <section id="plan-comptable">
            <h2>Plan comptable et num√©rotation</h2>

            <h3>Num√©rotation automatique</h3>

            <h4>Format OHADA (Cameroun)</h4>
            <div class="code-block">CM + Classe + Num√©ro s√©quentiel
Exemples :
- CM101000 : Capital social
- CM101001 : Actionnaire Oumarou Gaston
- CM521000 : Banque principale</div>

            <h4>Format Fran√ßais</h4>
            <div class="code-block">Classe + Num√©ro s√©quentiel
Exemples :
- 101000 : Capital social
- 101001 : Actionnaire 1
- 512000 : Banque</div>

            <h3>Classes comptables</h3>

            <table>
                <thead>
                    <tr>
                        <th>Classe</th>
                        <th>Description</th>
                        <th>Type</th>
                        <th>Exemples</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1</td>
                        <td>Comptes de capitaux</td>
                        <td>Passif</td>
                        <td>Capital, R√©serves</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>Immobilisations</td>
                        <td>Actif</td>
                        <td>Mat√©riel, Brevets</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>Stocks</td>
                        <td>Actif</td>
                        <td>Marchandises</td>
                    </tr>
                    <tr>
                        <td>4</td>
                        <td>Comptes de tiers</td>
                        <td>Actif/Passif</td>
                        <td>Clients, Fournisseurs</td>
                    </tr>
                    <tr>
                        <td>5</td>
                        <td>Comptes financiers</td>
                        <td>Actif</td>
                        <td>Banque, Caisse</td>
                    </tr>
                    <tr>
                        <td>6</td>
                        <td>Charges</td>
                        <td>R√©sultat</td>
                        <td>Achats, Salaires</td>
                    </tr>
                    <tr>
                        <td>7</td>
                        <td>Produits</td>
                        <td>R√©sultat</td>
                        <td>Ventes, Prestations</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <footer>
            <p><strong>Guide de Comptabilit√© - Syst√®me Multi-Devises</strong></p>
            <p>Version mise √† jour - Octobre 2025</p>
            <p>Avec gestion compl√®te des utilisateurs et s√©curit√© renforc√©e</p>
        </footer>
    </div>
</body>
</html>